
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1 I spy with my little eye &#8212;   documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2 This week’s quiz" href="Part_07_03.html" />
    <link rel="prev" title="Introduction" href="Part_07_01.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="1-I-spy-with-my-little-eye">
<h1>1 I spy with my little eye<a class="headerlink" href="#1-I-spy-with-my-little-eye" title="Permalink to this headline">¶</a></h1>
<p>One of the ways you are shown for loading World Bank data into the notebook in Week 7, was to use the <code class="docutils literal notranslate"><span class="pre">download</span> <span class="pre">()</span></code> function.</p>
<p><img alt="A close-up image of a green eye" src="../../_images/ou_futurelearn_learn_to_code_fig_1059.jpg" /></p>
<p><strong>Figure 1</strong></p>
<p>One way to find out for yourself what sorts of argument a function expects is to ask it. Running a code cell containing a question mark (?) followed by a function name should pop up a help area in the bottom of the notebook window. (Close it using the x in the top right hand corner of the panel.)</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>from pandas.io.wb import download
?download
</pre></div>
</div>
</div>
<p>The function documentation tells you that you can enter a list of one or more country names using standard country codes as well as a date range. You can also calculate a date range from a single date to show the <code class="docutils literal notranslate"><span class="pre">N</span></code> years of data leading up to a particular year.</p>
<p>Note that if you are using the CoCalc free plan, you will not be able to use the <code class="docutils literal notranslate"><span class="pre">download</span> <span class="pre">()</span></code> function to download the data directly from the World Bank API, although you will still be able to inspect the documentation associated with the function.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>YEAR = 2013
GDP_INDICATOR = &#39;NY.GDP.MKTP.CD&#39;

gdp = download(indicator=GDP_INDICATOR, country=[&#39;GB&#39;,&#39;CN&#39;], start=YEAR-5, end=YEAR)

gdp = gdp.reset_index()
gdp
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings"><caption></caption><tbody><tr><th></th><th><p>country</p>
</th><th><p>year</p>
</th><th><p>NY.GDP.MKTP.CD</p>
</th></tr><tr><td class="highlight_" rowspan colspan><p><strong>0</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2013</p>
</td><td class="highlight_" rowspan colspan><p>9.490603e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>1</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2012</p>
</td><td class="highlight_" rowspan colspan><p>8.461623e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>2</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2011</p>
</td><td class="highlight_" rowspan colspan><p>7.492432e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>3</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2010</p>
</td><td class="highlight_" rowspan colspan><p>6.039659e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>4</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2009</p>
</td><td class="highlight_" rowspan colspan><p>5.059420e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>5</strong></p>
</td><td class="highlight_" rowspan colspan><p>China</p>
</td><td class="highlight_" rowspan colspan><p>2008</p>
</td><td class="highlight_" rowspan colspan><p>4.558431e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>6</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2013</p>
</td><td class="highlight_" rowspan colspan><p>2.678173e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>7</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2012</p>
</td><td class="highlight_" rowspan colspan><p>2.614946e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>8</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2011</p>
</td><td class="highlight_" rowspan colspan><p>2.592016e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>9</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2010</p>
</td><td class="highlight_" rowspan colspan><p>2.407857e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>10</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2009</p>
</td><td class="highlight_" rowspan colspan><p>2.308995e+12</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p><strong>11</strong></p>
</td><td class="highlight_" rowspan colspan><p>United Kingdom</p>
</td><td class="highlight_" rowspan colspan><p>2008</p>
</td><td class="highlight_" rowspan colspan><p>2.791682e+12</p>
</td></tr></tbody></table><p>Although many datasets that you are likely to work with are published in the form of a single data table, such as a single CSV file or spreadsheet worksheet, it is often possible to regard the dataset as being made up from several distinct subsets of data.</p>
<p>In the above example, you will probably notice that each country name appears in several rows, as does each year. This suggests that we can make different sorts of comparisons between different groupings of data using just this dataset. For example, compare the total GDP of each country calculated over the six years 2008 to 2013 using just a single line of code:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp.groupby('country')['NY.GDP.MKTP.CD'].aggregate(sum)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>country
China             4.110217e+13
United Kingdom    1.539367e+13
Name: NY.GDP.MKTP.CD, dtype: float64
</pre></div>
</div>
</div>
<p>Essentially what this does is to say ‘for each country, find the total GDP’.</p>
<p>The total combined GDP for those two countries in each year could be found by making just one slight tweak to our code (can you see below where I made the change?):</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp.groupby('year')['NY.GDP.MKTP.CD'].aggregate(sum)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>year
2008    7.350113e+12
2009    7.368415e+12
2010    8.447515e+12
2011    1.008445e+13
2012    1.107657e+13
2013    1.216878e+13
Name: NY.GDP.MKTP.CD, dtype: float64
</pre></div>
</div>
</div>
<p>That second calculation probably doesn’t make much sense in this particular case, but what if there was another column saying which region of the world each country was in? Then, by taking the data for all the countries in the world, the total GDP could be found for each region by grouping on <em>both</em> the year <em>and</em> the region.</p>
<p>Next, you will consider ways of grouping data.</p>
<div class="section" id="1.1-Ways-of-grouping-data">
<h2>1.1 Ways of grouping data<a class="headerlink" href="#1.1-Ways-of-grouping-data" title="Permalink to this headline">¶</a></h2>
<p>Think back to the weather dataset you used in Week 3 , how might you group that data into several distinct groups? What sorts of comparisons could you make by grouping just the elements of that dataset? Or how might you group and compare the GDP data?</p>
<p><img alt="A very colourful image of piles of different peppers" src="../../_images/ou_futurelearn_learn_to_code_fig_1060.jpg" /></p>
<p><strong>Figure 2</strong></p>
<p>One thing the newspapers love to report are weather ‘records’, such as the ‘hottest June ever’ or the wettest location in a particular year as measured by total annual rainfall, or highest average monthly rainfall. How easy is it to find that information out from the data?</p>
<p>Or with the GDP data, if countries were assigned to economic groupings such as the European Union, or regional groupings such as Africa, or South America, how would you generate information such as lowest GDP in the EU or highest GDP in South America?</p>
<p>This week you will learn how to split data into groups based on particular features of the data, and then generate information about each separate group, across all of the groups, at the same time.</p>
<div class="section" id="Activity-1-Grouping-data">
<h3>Activity 1 Grouping data<a class="headerlink" href="#Activity-1-Grouping-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Question">
<h4>Question<a class="headerlink" href="#Question" title="Permalink to this headline">¶</a></h4>
<p>Based on the data you have seen so far, or some other datasets you may be aware of, what other ways of grouping data can you think of, and why might grouping data that way be useful?</p>
</div>
</div>
</div>
<div class="section" id="1.2-Data-that-describes-the-world-of-trade">
<h2>1.2 Data that describes the world of trade<a class="headerlink" href="#1.2-Data-that-describes-the-world-of-trade" title="Permalink to this headline">¶</a></h2>
<p>A news article from the <em>Guardian</em> announcing a gloomy export outlook for UK manufacturers (see the link below), got me wondering about what sorts of thing different countries actually export.</p>
<p>For example, it might surprise you that India was the world’s largest exporter by value of unset diamonds in 2014 (24 billion US dollars worth), or that Germany was the biggest importer of chocolate (over $2.5 billion worth) in that same year.</p>
<p>National governments all tend to publish their own trade figures, but the UN also collect data from across the world. In particular, the UN’s global trade database, Comtrade, contains data about import and export trade flows between countries for a wide range of goods and services.</p>
<p><img alt="An image of a China Shipping Lane cargo ship passing under the San Francisco bridge" src="../../_images/ou_futurelearn_learn_to_code_fig_1061.jpg" /></p>
<p><strong>Figure 3</strong></p>
<p>So if you’ve ever wondered where your country imports most of its T-shirts from, or exports most of its municipal waste to, Comtrade is likely to have the data.</p>
<p>In the next section, you will find out about the Comtrade data.</p>
</div>
<div class="section" id="1.3-Exploring-the-world-of-export-data">
<h2>1.3 Exploring the world of export data<a class="headerlink" href="#1.3-Exploring-the-world-of-export-data" title="Permalink to this headline">¶</a></h2>
<p>The Comtrade Data Extraction interface provides a user interface for selecting, previewing and exporting data from the Comtrade database.</p>
<div class="section" id="Activity-2-Exploring-export-data">
<h3>Activity 2 Exploring export data<a class="headerlink" href="#Activity-2-Exploring-export-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>Question<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Open the <a class="reference external" href="http://comtrade.un.org/data/">Comtrade Data Extraction interface</a> and keep it open alongside this page. You’ll explore the options and preview some data.</p>
<p><img alt="figure images/ou_futurelearn_learn_to_code_fig_1020.jpg" src="../../_images/ou_futurelearn_learn_to_code_fig_1020.jpg" /></p>
<p><strong>Figure 4:</strong> Comtrade Data Extraction interface</p>
<p>In the text area marked <strong>HS (as reported) commodity codes</strong> , start to enter the name of various goods and services. You should see suggestions regarding different goods and services that Comtrade records trade flow data for.</p>
<p>If you don’t select too much data, you should be able to get a preview of the data by clicking the green ‘Preview’ button. Notice that the interface allows you to sort the data by a particular column, which provides a quick way of finding the countries that export most, or least, goods by value.</p>
<p>If you selected ‘All’ reporters, you will probably notice that a decreasing sort on the ‘Trade Value’ column always has ‘World’ at the top: in the ‘All’ reports dataset, individual country reports and reports from ‘areas not elsewhere specified’ (‘nes’) are complemented by the ‘World’ report which represents a sum total of those other values.</p>
<p>The user interface is rather complicated at first glance, but with a bit of trial and error you should be able to work out:</p>
<ul class="simple">
<li><p>how to display trade flows between a particular country (the ‘Reporter’) and a particular country or region of the world (the ‘Partners’)</p></li>
<li><p>how to limit the display to show just imports, or exports, between ‘Reporter(s)’ and ‘Partner(s)’</p></li>
<li><p>how to display data for different years</p></li>
<li><p>how to display data for different months in a particular year, or all the months in a particular year.</p></li>
</ul>
<p>You might notice that the commodities codes are organised hierarchically, i.e. a code breaks down into further sub-codes. For example:</p>
<ul class="simple">
<li><p>3825 – Residual products of the chemical or allied industries 382510 – Municipal waste382520 – Sewage sludge382530 – Clinical waste…</p></li>
</ul>
<p>Adding up the results from the next level down on a particular code should generate trade value totals that correspond to the higher level totals, rounding errors aside. This means that if you want to focus on the subcategories of a particular commodity type, you may well be able to do so.</p>
<p>For a particular category of goods, and a reporting period of a single month or year, select your country as the reporter and ‘All’ as the partner.</p>
<p>Does the range of goods and services listed within the database surprise you?</p>
<p>Keep the Comtrade webpage open as you’ll use it again in the next section.</p>
</div>
</div>
</div>
<div class="section" id="1.4-Getting-data-from-the-Comtrade-API">
<h2>1.4 Getting data from the Comtrade API<a class="headerlink" href="#1.4-Getting-data-from-the-Comtrade-API" title="Permalink to this headline">¶</a></h2>
<p>Hopefully, you have a few ideas about data you’d like to explore from the Comtrade database.</p>
<p>In the previous section, I managed to identify a set of data that describes the amount of unset diamonds (commodity code 7102) imported into the UK from the Russian Federation, Angola and South Africa in 2013 and 2014.</p>
<p><img alt="figure images/ou_futurelearn_learn_to_code_fig_1021.jpg" src="../../_images/ou_futurelearn_learn_to_code_fig_1021.jpg" /></p>
<p><strong>Figure 5</strong> Comtrade Data Extraction interface</p>
<p>You can export the data you have selected as a CSV file that will be downloaded to your own computer by clicking on the <em>Download CSV</em> button. You may find it useful to change the filename of the downloaded file to something more meaningful than the comtrade.csv default name.</p>
<p>If you moved the downloaded CSV file into the same folder as your Exercise notebook 4 (that you’ll download later), you could use the following command to load the data into a pandas dataframe:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>filename=&#39;comtrade.csv

&#39; df=read_csv(filename, dtype={&#39;Commodity Code&#39;:str, &#39;Reporter Code&#39;:str })

</pre></div>
</div>
</div>
<p>The ‘Commodity Code’ and ‘Reporter Code’ values are explicitly read in as a string <code class="docutils literal notranslate"><span class="pre">(str)</span></code> otherwise codes like 0401 will be returned as the number 401.</p>
<p>One of the problems of working with real data like this is that it may not be just the data you want. The data returned from Comtrade includes several columns that are essentially surplus to requirements for the reports you will produce. I suggest that you clean the dataframes so that they contain at most the following key columns: ‘Year’, ‘Period’, ‘Trade Flow’, ‘Reporter’, ‘Partner’, ‘Commodity’, ‘Commodity Code’, ‘Trade Value (US$)’.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>


<span></span>COLUMNS = [&#39;Year&#39;, &#39;Period&#39;,&#39;Trade Flow&#39;,&#39;Reporter&#39;,&#39;Partner&#39;, &#39;Commodity&#39;,&#39;Commodity Code&#39;,&#39;Trade Value (US$)&#39;]

df=df[COLUMNS]
</pre></div>
</div>
</div>
<p>To avoid conflating data relating to all countries (the ‘World’ partner), and each separate country, create separate dataframes for each, using the comparison operators introduced in Week 3.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>world = df[df[&#39;Partner&#39;] == &#39;World&#39;]
countries = df[df[&#39;Partner&#39;] != &#39;World&#39;]
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="A-More-Direct-Way-of-Getting-the-Data">
<h3>A More Direct Way of Getting the Data<a class="headerlink" href="#A-More-Direct-Way-of-Getting-the-Data" title="Permalink to this headline">¶</a></h3>
<p>Just as there was a method for downloading data directly from the World Bank, there is also a more direct way of getting the Comtrade data into a dataframe – directly from the Comtrade website. You might have noticed that when you downloaded the file from the Comtrade website, a link appeared on the site labelled ‘View API Call’.</p>
<p>An API is an ‘application programming interface’ that provides a means for one computer to talk to another ‘in machine terms’. When you extracted data from the World Bank, you were calling the World Bank API using a set of functions provided by the pandas library. Behind the scenes, these functions create URLs (that is, web addresses) that call the World Bank API and allow requests to be made directly from it, putting the response into a pandas dataframe.</p>
<p>In the case of Comtrade, clicking the <em>View API Link</em> reveals a URL that requests the data you selected in the search form as a data file, though not, by default, as a CSV data file.</p>
<p>This link can be used to download data directly into a pandas dataframe from Comtrade, although you will need to make a couple of modifications to the URL first. In particular, change the max value to 5000 (to increase the amount of data returned by each request) and add <code class="docutils literal notranslate"><span class="pre">&amp;amp;fmt=csv</span></code> to the end of the URL to ensure that the data is returned in a CSV format.</p>
<p>For example, if you copied the URL:</p>
<p><a class="reference external" href="http://comtrade.un.org/api/get?max=500&amp;type=C&amp;freq=M&amp;px=HS&amp;ps=2015&amp;r=826&amp;p=all&amp;rg=1%2C2&amp;cc=0401%2C0402">http://comtrade.un.org/api/get?max=500&amp;type=C&amp;freq=M&amp;px=HS&amp;ps=2015&amp;r=826&amp;p=all&amp;rg=1%2C2&amp;cc=0401%2C0402</a></p>
<p>you would need to modify it as follows:</p>
<p><a class="reference external" href="http://comtrade.un.org/api/get?max=">http://comtrade.un.org/api/get?max=</a> <strong>5000</strong> &amp;type=C&amp;freq=M&amp;px=HS&amp;ps=2015&amp;r=826&amp;p=all&amp;rg=1%2C2&amp;cc=0401%2C0402 <strong>&amp;fmt=csv</strong></p>
<p>You can then load the data in using the panda <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function.</p>
<ul class="simple">
<li><p>Note that if you are using the CoCalc free plan, you will not be able to download data directly from the Comtrade API into a pandas dataframe. *</p></li>
</ul>
<p>Set the datatypes as shown using the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> argument to ensure that the codes are read in correctly.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>


<span></span>URL=&#39;http://comtrade.un.org/api/get?max=5000&amp;type=C&amp;freq=A&amp;px=HS&amp;ps=2014%2C2013%2C2012&amp;r=826&amp;p=all&amp;rg=all&amp;cc
=0401%2C0402&amp;fmt=csv&#39;


df=read_csv(URL, dtype={&#39;Commodity Code&#39;:str, &#39;Reporter Code&#39;:str})

</pre></div>
</div>
</div>
<p>Having downloaded the data, you should then separate out the World data as before.</p>
<p>If you want to save a copy of data downloaded into pandas directly from the Comtrade API, call the <code class="docutils literal notranslate"><span class="pre">to_csv()</span></code> method on your dataframe, pasting in the filename you want to save the file under, and setting <code class="docutils literal notranslate"><span class="pre">index=False</span></code> so that the dataframe’s automatically introduced index column is not included. For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">countries.to_csv('saved_country_data_example.csv',</span> <span class="pre">index=False)</span></code></p>
<p>The file will be saved in the same folder as the notebook.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="1.5-Practice-getting-data">
<h2>1.5 Practice getting data<a class="headerlink" href="#1.5-Practice-getting-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Exercise-1-Getting-data-from-API">
<h3>Exercise 1 Getting data from API<a class="headerlink" href="#Exercise-1-Getting-data-from-API" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id2">
<h4>Question<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>In Exercise 1, identify a dataset from the <a class="reference external" href="http://comtrade.un.org/data/">Comtrade Data Extraction interface</a> selecting one or more commodity codes and a single reporter that are of interest to you and import the data into pandas.</p>
<p>Open the exercise notebook 4 and save it in the disk folder or the CoCalc project you created in Week 1. You should also open the comtrade_pivot.html comtrade_milk_uk_monthly_14.csv files and save them into the same folder or project.</p>
<p>Remember to run the existing code in the notebook before you start the exercise. When you’ve completed the exercise, save the notebook. If you need a quick reminder of how to use Jupyter watch again the video in Week 1 Exercise 1.</p>
<p>For the commodities and reporter you chose, find out which countries are the biggest partners in recent years in terms of import and export trade flows.</p>
</div>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Part_07_01.html" title="Previous document">Introduction</a>
        </li>
        <li>
          <a href="Part_07_03.html" title="Next document">2 This week’s quiz</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html"></a></h1>



<p class="blurb">Documentation...</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_00/Part_00_01.html">Introduction and guidance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_00/Part_00_02.html">What is a badged course?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_00/Part_00_03.html">How to get a badge</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_01.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_02.html">1 Install the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_03.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_04.html">3 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_01.html">1 Enter the pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_02.html">2 Writing up the analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_04.html">4 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_03/Part_03_01.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_03/Part_03_02.html">1 Weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_03/Part_03_03.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_03/Part_03_04.html">3 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_04/Part_04_01.html">1 Loading the weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_04/Part_04_02.html">2 Every picture tells a story</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_04/Part_04_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_04/Part_04_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_04/Part_04_05.html">4.1 Week 4 glossary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_05/Part_05_01.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_05/Part_05_02.html">1 Life expectancy project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_05/Part_05_03.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_05/Part_05_04.html">3 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_06/Part_06_01.html">1 Joining left, right and centre</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_06/Part_06_02.html">2 Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_06/Part_06_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_06/Part_06_04.html">4 Summary</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Part_07_01.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">1 I spy with my little eye</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#1.1-Ways-of-grouping-data">1.1 Ways of grouping data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.2-Data-that-describes-the-world-of-trade">1.2 Data that describes the world of trade</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.3-Exploring-the-world-of-export-data">1.3 Exploring the world of export data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.4-Getting-data-from-the-Comtrade-API">1.4 Getting data from the Comtrade API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.5-Practice-getting-data">1.5 Practice getting data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Part_07_03.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="Part_07_04.html">3 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_08/Part_08_01.html">1 The split-apply-combine pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_08/Part_08_02.html">2 Pivot tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_08/Part_08_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_08/Part_08_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_08/Part_08_05.html">Tell us what you think</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Part_07_01.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="Part_07_03.html" title="next chapter">2 This week’s quiz</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/content/session_07/Part_07_02.md"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>